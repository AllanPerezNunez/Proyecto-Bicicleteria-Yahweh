<!--V. AGREGAR PRODUCTOS-->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Modificar Categoria</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
        <link rel="icon" href="/media/imagenes_bd/yahweh.png" type="image/x-icon">
      </head>
    <body>

{% csrf_token %}

<!--=========================================NAVBAR==================================================-->
  <nav class="navbar" aria-label="Light offcanvas navbar" style="background-color: #1ddf1b;position:fixed;top:0;width:100%;z-index:100;">
            <div class="container-fluid">
              <button class="navbar-toggler" style="background-color: #e50c57; color: white;" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span><label  style="margin-left: 10px;">Acciones</label>
              </button>
              <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasWithBothOptionsLabel">
                <div class="offcanvas-header">
                  <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Acciones</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                  <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                    <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="/dashboard">Inicio</a>
                      <a class="nav-link active" aria-current="page" href="/registrarproducto">Agregar Productos</a>
                      <a class="nav-link active" aria-current="page" href="/agregarhoras">Agregar Horas de Agendamiento</a>
                      <a class="nav-link active" aria-current="page" href="/agregarcategorias">Agregar Categorias</a>
                      <a class="nav-link active" aria-current="page" href="/listarproductos">Listar Productos</a>
                      <a class="nav-link active" aria-current="page" href="/listarusuarios">Listar Usuarios</a>
                      <a class="nav-link active" aria-current="page" href="/listarcategorias">Listar Categorias</a>
                      <a class="nav-link active" aria-current="page" href="/lista_agendas">Agendamientos</a>
                      <a class="nav-link active" aria-current="page" href="/seguimiento_admin">Seguimiento Compras online</a>
                      <a class="nav-link active" aria-current="page" href="/presencial_admin">Despacho Presencial</a> 
                      <a class="nav-link active" aria-current="page" href="/listar_historial">Historial de Acciones</a>
                      <a class="nav-link active" aria-current="page" href="/cerrar Sesion">Cerrar Sesion</a>  
                    </li>
                  </ul>
                  
                </div>
              </div>
              <a class="navbar-brand" href="/dashboard" style="display: flex; align-items: center; text-decoration: none;position:relative;left:-70%;"><!--HREF DEBE LLEVAR AL DASHBOARD-->
                <img src="/media/imagenes_bd/yahweh.png" style="width:40px; height:40px;">
                <h3 style="font-size:20px; color: black;">Bicicletería Yahweh</h3>
              </a>
            </div>
  </nav>
<!--=================================FIN NAVBAR===========================================================-->


        <div class="container" style="border:2px solid #1ddf1b;padding:20px;margin-top:7%;margin-bottom:7%;">
          <br/>

          <h1 class="text-center">Registro de Categorias</h1>

          <br/>
          {% if r %}
          <div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong>¡Felicitaciones!</strong> {{r}}
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
          {% endif %}
        
        <br/>

            <form id="form-actualizar-categoria" action="/actualizarcategoria/{{cat.id}}" method="post" enctype="multipart/form-data"> 
                <div class="form-group">

                    {% csrf_token %}
                   
                    
                    <label for="txtnom">Nombre de la categoria</label>
                    <input type="text" id="txtnom" name="txtnom" required class="form-control" value="{{cat.descripcion}}"/>

                    
                    <br/>
                    
                    <input type="submit" value="Modificar Categoria" class="btn btn-primary btn-lg" style="width:100%; background-color:#e50c57;font-weight:bold;border:none;"/>
                    <br/>
                </div>
            </form>

        </div>

        <!--SCRIPT MOTIVO ACTUALIZAR-->
        <script>
          document.getElementById('form-actualizar-categoria').addEventListener('submit', function(event){
              event.preventDefault(); // evitar submit inmediato
              
              // Mostrar prompt para motivo
              let motivo = prompt("Por favor, ingresa el motivo de la actualización:");
              
              if (motivo === null || motivo.trim() === "") {
                  alert("El motivo es obligatorio para actualizar.");
                  return; // no envía el formulario
              }
              
              // Crear un input hidden para enviar el motivo junto con el form
              let inputMotivo = document.createElement('input');
              inputMotivo.type = 'hidden';
              inputMotivo.name = 'motivo';
              inputMotivo.value = motivo;
              
              this.appendChild(inputMotivo);
              this.submit();  // ahora sí envía el formulario
          });
        </script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    </body>
</html>