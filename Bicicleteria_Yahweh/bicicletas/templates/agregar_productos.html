<!--V. AGREGAR PRODUCTOS-->
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Registrar Productos</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
        <link rel="icon" href="/media/imagenes_bd/yahweh.png" type="image/x-icon">
    </head>

    
    <body>
{% csrf_token %}

<!--=========================================NAVBAR==================================================-->
  <nav class="navbar" aria-label="Light offcanvas navbar" style="background-color: #1ddf1b;position:fixed;top:0;width:100%;z-index:100;">
            <div class="container-fluid">
              <button class="navbar-toggler" style="background-color: #e50c57; color: white;" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span><label  style="margin-left: 10px;">Acciones</label>
              </button>
              <div class="offcanvas offcanvas-start" data-bs-scroll="true" tabindex="-1" id="offcanvasNavbar" aria-labelledby="offcanvasWithBothOptionsLabel">
                <div class="offcanvas-header">
                  <h5 class="offcanvas-title" id="offcanvasWithBothOptionsLabel">Acciones</h5>
                  <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                </div>
                <div class="offcanvas-body">
                  <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
                    <li class="nav-item">
                      <a class="nav-link active" aria-current="page" href="/dashboard">Inicio</a>
                      <a class="nav-link active" aria-current="page" href="/registrarproducto">Agregar Productos</a>
                      <a class="nav-link active" aria-current="page" href="/agregarhoras">Agregar Horas de Agendamiento</a>
                      <a class="nav-link active" aria-current="page" href="/agregarcategorias">Agregar Categorias</a>
                      <a class="nav-link active" aria-current="page" href="/listarproductos">Listar Productos</a>
                      <a class="nav-link active" aria-current="page" href="/listarusuarios">Listar Usuarios</a>
                      <a class="nav-link active" aria-current="page" href="/listarcategorias">Listar Categorias</a>
                      <a class="nav-link active" aria-current="page" href="/lista_agendas">Agendamientos</a>
                      <a class="nav-link active" aria-current="page" href="/seguimiento_admin">Seguimiento Compras online</a>
                      <a class="nav-link active" aria-current="page" href="/presencial_admin">Despacho Presencial</a> 
                      <a class="nav-link active" aria-current="page" href="/listar_historial">Historial de Acciones</a> 
                      <a class="nav-link active" aria-current="page" href="/cerrar Sesion">Cerrar Sesion</a> 
                    </li>
                  </ul>
                  
                </div>
              </div>
              <a class="navbar-brand" href="/dashboard" style="display: flex; align-items: center; text-decoration: none;position:relative;left:-70%;"><!--HREF DEBE LLEVAR AL DASHBOARD-->
                <img src="/media/imagenes_bd/yahweh.png" style="width:40px; height:40px;">
                <h3 style="font-size:20px; color: black;">Bicicletería Yahweh</h3>
              </a>
            </div>
  </nav>
<!--=================================FIN NAVBAR===========================================================-->




        

          <div class="container" style="border:2px solid #1ddf1b;padding:20px;margin-top:7%;margin-bottom:5%;">
            
            <h1 class="text-center">Registro de Productos</h1>
            
            <br/>
            {% if r %}
              <div class="alert alert-success alert-dismissible fade show" role="alert">
                <strong>¡Felicitaciones!</strong> {{r}}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endif %}
        
            <br/>

            <form action="/insertarproducto" method="post" enctype="multipart/form-data"> 
              {% csrf_token %}
                <div class="form-group">
                
                   
                    <label for="txtima">Imagen del Producto</label>
                    <input type="file" class="form-control" id="txtima" name="txtima" accept="image/png, image/gif, image/jpeg">

                    <br/>

                    <label for="txtfac">Número de Factura</label>
                    <input type="text" id="txtfac" name="txtfac" required class="form-control" />

                    <br/>

                    <label for="txtnom">Nombre del producto</label>
                    <input type="text" id="txtnom" name="txtnom" required class="form-control" />

                    <br/>

                    <label for="txtdes">Descripcion del producto</label>
                    <textarea class="form-control" id="txtdes" rows="3" name="txtdes"></textarea>
                                  
                    <br/>

                    <label for="txtsto">Stock del Producto</label>
                    <input type="number" class="form-control" required name="txtsto" pattern="\d*" min="1" id="txtsto">

                    <br/>

                    <label for="txtcos">Precio de Compra:</label>
                    <input type="number" id="txtcos" name="txtcos" step="0.01" style="margin-right:9%">

                    <label for="cbouti">Utilidad:</label>
                    <select id="cbouti" name="cbouti" style="margin-right:9%" required>
                      <option value="" disabled selected>Seleccione utilidad</option>
                      <option value="0.10">10%</option>
                      <option value="0.15">15%</option>
                      <option value="0.20">20%</option>
                      <option value="0.25">25%</option>
                      <option value="0.30">30%</option>
                    </select>

                    <label for="txtpre">Precio de Venta:</label>
                    <input type="number" id="txtpre" name="txtpre" step="0.01" readonly>

                    <br/><br/>

                    <label for="cboprov">Proveedor</label>
                    <select name="cboprov" required class="custom-select" id="cboprov" style="margin-right:5%">
                        <option value="">Seleccione Proveedor</option>
                    
                        {% for x in prov %}
                            <option value="{{x.descripcion}}">{{x.descripcion}}</option>
                        {% endfor%}
                    </select>

                    <label for="cbomat">Material del producto</label>
                    <select name="cbomat" required class="custom-select" id="cbomat" style="margin-right:5%">
                        <option value="">Seleccione Material</option>
                        {% for mat in materiales %}
                            <option value="{{ mat }}" {% if pro.material == mat %}selected{% endif %}>{{ mat }}</option>
                        {% endfor %}
                    </select>

                    <label for="cbotip">Tipo de producto</label>
                    <select name="cbotip" required class="custom-select" id="cbotip">
                        <option value="">Seleccione Tipo de producto</option>
                    
                        {% for x in tippro %}
                            <option value="{{x.descripcion}}">{{x.descripcion}}</option>
                        {% endfor%}
                    </select>

                    <br/><br/><br/>
                    
                    <input type="submit" value="Agregar Producto" class="btn btn-primary btn-lg" style="width:100%; background-color:#e50c57;font-weight:bold;border:none;"/>
                    
                </div>
            </form>
            <br/>
        </div>

        <!--SCRIPT PARA CALCULAR UTILIDAD-->
        <script>
          const costoInput = document.getElementById('txtcos');
          const utilidadSelect = document.getElementById('cbouti');
          const ventaInput = document.getElementById('txtpre');

          function calcularPrecioVenta() {
            const costo = parseFloat(costoInput.value);
            const utilidad = parseFloat(utilidadSelect.value);

            if (!isNaN(costo) && !isNaN(utilidad)) {
              const precio = costo + (costo * utilidad);
              ventaInput.value = Math.round(precio);
            } else {
              ventaInput.value = '';
            }
          }

          costoInput.addEventListener('input', calcularPrecioVenta);
          utilidadSelect.addEventListener('change', calcularPrecioVenta);
        </script>




        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    </body>
</html>